<!DOCTYPE html>
<html>
<head>
    <title>Test Image Fix - R-Mart</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .product { border: 1px solid #ddd; margin: 10px; padding: 10px; display: inline-block; width: 300px; }
        .product img { width: 100%; height: 200px; object-fit: cover; }
        .test-section { margin: 20px 0; padding: 20px; border: 2px solid #007AFF; }
    </style>
</head>
<body>
    <h1>ðŸ›’ R-Mart Image Fix Test</h1>
    
    <div class="test-section">
        <h2>1. Test Static Resource Controller</h2>
        <p>Testing direct image access:</p>
        <img src="http://localhost:8191/uploads/images/1756729771820_test-upload.jpg" alt="Test Image" style="max-width: 200px;">
        <p>URL: <a href="http://localhost:8191/uploads/images/1756729771820_test-upload.jpg" target="_blank">http://localhost:8191/uploads/images/1756729771820_test-upload.jpg</a></p>
    </div>

    <div class="test-section">
        <h2>2. Test Product API with Images</h2>
        <div id="products"></div>
        <button onclick="loadProducts()">Load Products</button>
    </div>

    <div class="test-section">
        <h2>3. Test Admin Dashboard Products</h2>
        <div id="adminProducts"></div>
        <button onclick="loadAdminProducts()">Load Admin Products</button>
    </div>

    <script>
        async function loadProducts() {
            try {
                const response = await fetch('http://localhost:8191/api/products');
                const data = await response.json();
                
                const productsDiv = document.getElementById('products');
                productsDiv.innerHTML = '';
                
                if (data.status && data.data.products) {
                    data.data.products.slice(0, 3).forEach(product => {
                        const productDiv = document.createElement('div');
                        productDiv.className = 'product';
                        productDiv.innerHTML = `
                            <h3>${product.name}</h3>
                            <img src="${product.image}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/300x200?text=Image+Error'">
                            <p>Price: $${product.price}</p>
                            <p>Image URL: ${product.image}</p>
                        `;
                        productsDiv.appendChild(productDiv);
                    });
                } else {
                    productsDiv.innerHTML = '<p>Error loading products: ' + data.message + '</p>';
                }
            } catch (error) {
                document.getElementById('products').innerHTML = '<p>Error: ' + error.message + '</p>';
            }
        }

        async function loadAdminProducts() {
            try {
                const response = await fetch('http://localhost:8191/api/admin/products');
                const data = await response.json();
                
                const adminProductsDiv = document.getElementById('adminProducts');
                adminProductsDiv.innerHTML = '';
                
                if (data.status && data.data.products) {
                    data.data.products.slice(0, 3).forEach(product => {
                        const productDiv = document.createElement('div');
                        productDiv.className = 'product';
                        productDiv.innerHTML = `
                            <h3>${product.name}</h3>
                            <img src="${product.image}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/300x200?text=Image+Error'">
                            <p>Price: $${product.price}</p>
                            <p>Image URL: ${product.image}</p>
                        `;
                        adminProductsDiv.appendChild(productDiv);
                    });
                } else {
                    adminProductsDiv.innerHTML = '<p>Error loading admin products: ' + data.message + '</p>';
                }
            } catch (error) {
                document.getElementById('adminProducts').innerHTML = '<p>Error: ' + error.message + '</p>';
            }
        }

        // Auto load on page load
        window.onload = function() {
            loadProducts();
            loadAdminProducts();
        };
    </script>
</body>
</html>