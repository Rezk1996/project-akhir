<!DOCTYPE html>
<html>
<head>
    <title>Test Employee Email Field</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .success { color: green; }
        .error { color: red; }
        .result { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        input { padding: 8px; margin: 5px; width: 200px; }
    </style>
</head>
<body>
    <h1>Employee Email Field Test</h1>
    
    <div>
        <h3>Create Employee with Email</h3>
        <input type="text" id="nama" placeholder="Full Name" value="Test User">
        <input type="email" id="email" placeholder="Email" value="test.user@rmart.com">
        <input type="text" id="phone" placeholder="Phone" value="081234567890">
        <input type="text" id="position" placeholder="Position" value="Staff">
        <button onclick="createEmployeeWithEmail()">Create Employee</button>
    </div>
    
    <div>
        <button onclick="getEmployees()">Get All Employees</button>
        <button onclick="createEmployeeWithoutEmail()">Create Employee (No Email)</button>
    </div>
    
    <div id="result"></div>

    <script>
        const API_BASE = 'http://localhost:8191/api';
        
        async function makeRequest(url, options = {}) {
            try {
                const response = await fetch(url, {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    },
                    ...options
                });
                
                const data = await response.json();
                return { status: response.status, data };
            } catch (error) {
                return { error: error.message };
            }
        }
        
        function displayResult(title, result) {
            const resultDiv = document.getElementById('result');
            const statusClass = result.error ? 'error' : (result.status === 200 ? 'success' : 'error');
            
            resultDiv.innerHTML = `
                <div class="result">
                    <h3>${title}</h3>
                    <p class="${statusClass}">Status: ${result.status || 'Error'}</p>
                    <pre>${JSON.stringify(result.data || result.error, null, 2)}</pre>
                </div>
            `;
        }
        
        async function createEmployeeWithEmail() {
            const employeeData = {
                nama: document.getElementById('nama').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                position: document.getElementById('position').value
            };
            
            const result = await makeRequest(`${API_BASE}/admin/employees`, {
                method: 'POST',
                body: JSON.stringify(employeeData)
            });
            displayResult('Create Employee with Email', result);
        }
        
        async function createEmployeeWithoutEmail() {
            const employeeData = {
                nama: "Auto Email User",
                phone: "081999888777",
                position: "Cashier"
                // No email field - should auto-generate
            };
            
            const result = await makeRequest(`${API_BASE}/admin/employees`, {
                method: 'POST',
                body: JSON.stringify(employeeData)
            });
            displayResult('Create Employee without Email (Auto-generate)', result);
        }
        
        async function getEmployees() {
            const result = await makeRequest(`${API_BASE}/admin/employees`);
            displayResult('Get All Employees (Check Email Field)', result);
        }
        
        // Auto-load employees on page load
        window.onload = () => {
            getEmployees();
        };
    </script>
</body>
</html>